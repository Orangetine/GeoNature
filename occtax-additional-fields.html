<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Occtax - Champs additionnels &mdash; Documentation GeoNature 2.0</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=e8570148"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/translations.js?v=d99ca74e"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >

          
          
          <a href="index.html" class="icon icon-home">
            GeoNature
              <img src="_static/LogoGeonature.jpg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">INSTALLATION</a></li>
<li class="toctree-l1"><a class="reference internal" href="user-manual.html">MANUEL UTILISATEUR</a></li>
<li class="toctree-l1"><a class="reference internal" href="admin-manual.html">MANUEL ADMINISTRATEUR</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">DEVELOPPEMENT</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html#tests-backend">Tests backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">AUTEURS</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">CHANGELOG</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-references.html">API REFERENCES</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: white" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GeoNature</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Occtax - Champs additionnels</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/occtax-additional-fields.md.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="occtax-champs-additionnels">
<h1>Occtax - Champs additionnels<a class="headerlink" href="#occtax-champs-additionnels" title="Link to this heading"></a></h1>
<p>Les champs additionnels peuvent être définis à chacun des trois niveaux du formulaire (objet de rattachement):</p>
<ul class="simple">
<li><p>releve</p></li>
<li><p>occurrence</p></li>
<li><p>dénombrement</p></li>
</ul>
<p>Le endpoint pour connaitre les champs additionnels est :</p>
<ul class="simple">
<li><p><a class="reference external" href="https://URL/geonature/api/gn_commons/additional_fields?module_code=OCCTAX">https://URL/geonature/api/gn_commons/additional_fields?module_code=OCCTAX</a></p></li>
</ul>
<p>Le JSON renvoie le tableau de champs additionnels d’Occtax (trois niveaux du formulaire confondu).</p>
<p>Pour connaitre le niveau (releve, occurrence, dénombrement), on regarde la tableau de l’attribut « objects » qui contient un attribut « code_object »</p>
<ul class="simple">
<li><p>revele = OCCTAX_OCCURENCE</p></li>
<li><p>occurrence = OCCTAX_OCCURENCE</p></li>
<li><p>denombrement = OCCTAX_RELEVE</p></li>
</ul>
<p>Il y a aussi la possibilité de faire trois appels pour les distinguer :</p>
<ul class="simple">
<li><p><a class="reference external" href="https://URL/geonature/api/gn_commons/additional_fields?module_code=OCCTAX&amp;amp;object_code=OCCTAX_RELEVE">https://URL/geonature/api/gn_commons/additional_fields?module_code=OCCTAX&amp;object_code=OCCTAX_RELEVE</a></p></li>
<li><p><a class="reference external" href="https://URL/geonature/api/gn_commons/additional_fields?module_code=OCCTAX&amp;amp;object_code=OCCTAX_OCCURENCE">https://URL/geonature/api/gn_commons/additional_fields?module_code=OCCTAX&amp;object_code=OCCTAX_OCCURENCE</a></p></li>
<li><p><a class="reference external" href="https://URL/geonature/api/gn_commons/additional_fields?&amp;amp;module_code=OCCTAX&amp;amp;object_code=OCCTAX_DENOMBREMENT">https://URL/geonature/api/gn_commons/additional_fields?&amp;module_code=OCCTAX&amp;object_code=OCCTAX_DENOMBREMENT</a></p></li>
</ul>
<p>Les champs additionnels peuvent également être globaux à tout le module (à afficher tout le temps), ou simplement rattaché à un jeu de données (à afficher uniquement si ce jeu de donnée est selectionné)</p>
<p>On distingue les champs additionnels globaux de ceux rattaché à un JDD via l’attribut « datasets ». Si le tableau est vide alors ils sont globaux, sinon ils sont affichés uniquement quand un des JDD de ce tableau est
selectionné en interface.</p>
<section id="type-de-champs">
<h2>Type de champs<a class="headerlink" href="#type-de-champs" title="Link to this heading"></a></h2>
<p>Le JSON renvoyé par les routes précédentes contient un dictionnaire « type_widget » qui contient lui même l’information du type de widget sous l’attribut « widget_name ».</p>
<p>Les champs additionnels peuvent définir les « widgets » suivants :</p>
<ul class="simple">
<li><p>text (un champ comportant du texte libre : input type text)</p></li>
<li><p>textarea (input type textarea - champ comportant du texte libre)</p></li>
<li><p>number (input type number - entier ou réel)</p></li>
<li><p>html (champs de type « présentation » permettant de décorer le formulaire: peut contenir des balises html).</p></li>
<li><p>select (input type select. Les valeurs pour peupler l’input sont dans le champs « field_values » de la route)</p></li>
<li><p>radio (input type radio. Les valeurs pour peupler l’input sont dans le champs « field_values » de la route)</p></li>
<li><p>checkbox (input type checkbox. Les valeurs pour peupler l’input sont dans le champs « field_values » de la route. Ce widget renvoie toujours un tableau de valeurs.)</p></li>
<li><p>multiselect (input de type select à choix multiple.  Les valeurs pour peupler l’input sont dans le champs « field_values » de la route</p></li>
<li><p>nomenclature (un champ select renvoyant à une nomenclature GeoNature. Les valeurs de ce « select » sont donc à précharger en synchronisation. Le code de nomenclature se trouve à l’attribut « code_nomenclature_type »)</p></li>
</ul>
<p>Widget non géré :</p>
<ul class="simple">
<li><p>datalist : necessite de charger des liste à partir d’une API externe</p></li>
<li><p>time : l’heure est déjà gérée par occtax mobile</p></li>
<li><p>date : idem</p></li>
</ul>
</section>
<section id="autres-informations">
<h2>Autres informations<a class="headerlink" href="#autres-informations" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>l’attribut « required » (booléen) défini si le champs est obligatoire. On ne doit pas pouvoir passer à l’écran suivant si un des champs obligatoire n’est pas rempli</p></li>
<li><p>l’attribut « order » (integer) défini l’ordre d’affichage des champs pour chacun des trois niveaux du formulaire. Ce champs n’est pas obligatoire et peut être null. Si null alors le champs apparaît après ceux qui sont ordonnés</p></li>
<li><p>l’attribut « value » défini la valeur par défaut de l’input. Celle-ci est préchargée à l’affichage du champ</p></li>
<li><p>les champs de type nomenclature peuvent être filtrés selon leurs « cd_nomenclature ». Les cd_nomenclatures à filtrer se retrouve dans l’attribut « additional_attributes » puis « cd_nomenclatures » qui est un tableau. Le backend de geonature permet directement de filtrer ces cd_nomenclatures : <a class="reference external" href="https://URL/geonature/api/nomenclatures/nomenclature/VENT?regne=&amp;amp;group2_inpn=&amp;amp;orderby=label_default&amp;amp;cd_nomenclature=VENT_2&amp;amp;cd_nomenclature=VENT_3">https://URL/geonature/api/nomenclatures/nomenclature/VENT?regne=&amp;group2_inpn=&amp;orderby=label_default&amp;cd_nomenclature=VENT_2&amp;cd_nomenclature=VENT_3</a> (voir postman). Ce filtre pourrait également être fait côté mobile, au choix</p></li>
</ul>
</section>
</section>
<section id="medias">
<h1>Médias<a class="headerlink" href="#medias" title="Link to this heading"></a></h1>
<p>La route à utiliser est la suivante : <a class="reference external" href="https://URL/geonature/api/gn_commons/media">https://URL/geonature/api/gn_commons/media</a>.</p>
<p>L’idée est donc de d’abord poster l’occurence est ses dénombrement. L’API renvoie les dénombrements ainsi que les médias en conservant l’ordre de l’envoi.</p>
<p>On récupère donc l’UUID du dénombrement pour l’utiliser dans la route de POST des médias.</p>
<p>Celle-ci attend :</p>
<ul class="simple">
<li><p>id_table_location : <a class="reference external" href="https://URL/geonature/api/gn_commons/get_id_table_location/pr_occtax.cor_counting_occtax">https://URL/geonature/api/gn_commons/get_id_table_location/pr_occtax.cor_counting_occtax</a></p></li>
<li><p>id_nomenclature_media_type (on ne propose que « Photo » pour le mobile) : <a class="reference external" href="https://URL/geonature/api/nomenclatures/nomenclature/TYPE_MEDIA?regne=&amp;amp;group2_inpn=&amp;amp;orderby=label_default">https://URL/geonature/api/nomenclatures/nomenclature/TYPE_MEDIA?regne=&amp;group2_inpn=&amp;orderby=label_default</a></p></li>
<li><p>title_fr : <datetime> nom du taxon</p></li>
<li><p>description : <taxon> observé le &lt;date de l’obs&gt;</p></li>
<li><p>auteur : la personne loggué</p></li>
</ul>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2018-2023, PnE, PnC.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>